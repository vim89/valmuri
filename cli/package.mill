package build.cli

import mill._
import mill.javalib._
import mill.javalib.publish._
import mill.scalalib.SbtModule

object `package` extends RootModule with SbtModule with PublishModule {

  def artifactName = "valmuri-cli"

  def scalaVersion = "2.13.12"

  def scalacOptions: T[Seq[String]] = super.scalacOptions() ++ Seq(
    "-deprecation",
    "-feature",
    "-unchecked",
    "-Xfatal-warnings",
    "-encoding",
    "UTF-8",
    "-language:higherKinds",
    "-language:implicitConversions"
  )

  def ivyDeps: T[Agg[Dep]] = super.ivyDeps() ++ Agg(ivy"com.github.scopt::scopt:4.1.0")

  def moduleDeps: Seq[PublishModule] = super.moduleDeps ++ Agg(build)

  def pomSettings: T[PomSettings] = PomSettings(
    "valmuri-cli",
    "com.vitthalmirji",
    "",
    Seq(),
    VersionControl(
      Some("https://github.com/vim89/valmuri/valmuri-cli"),
      Some("scm:git:https://github.com/vim89/valmuri.git"),
      Some("scm:git:git@github.com:vim89/valmuri.git"),
      None
    ),
    Seq()
  )

  def publishVersion = "0.1.0-SNAPSHOT"

  trait test extends SbtTests {

    def testSandboxWorkingDir = false
    def testEnableWorkStealing = false
  }
}
